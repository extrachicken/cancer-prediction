# Предиктивная модель выявления типа опухоли

## Введение

Эта предиктивная модель разработана для классификации типа опухоли (злокачественная или доброкачественная) на основе данных из датасета Breast Cancer Wisconsin (Diagnostic). Модель использует логистическую регрессию с LASSO-регуляризацией для отбора наиболее значимых признаков и предсказания результатов.

## Требования

Для работы с этим скриптом вам понадобится:
- R (версия 4.0 или выше)
- Библиотеки:
  - `tidyverse` — для обработки данных
  - `glmnet` — для реализации LASSO-регрессии
  - `caret` — для разделения данных и кросс-валидации
  - `pROC` — для построения ROC-кривой
  - `ggplot2` — для визуализации

## Установка

Установите необходимые библиотеки с помощью команды в R:
```R
install.packages(c("tidyverse", "glmnet", "caret", "pROC", "ggplot2"))
```

## Данные

Датасет Breast Cancer Wisconsin (Diagnostic) содержит измерения характеристик ядер клеток опухолей. В скрипте выполняется следующая подготовка данных:
- Удаляются неинформативные столбцы (`id`, `X`).
- Целевая переменная `diagnosis` преобразуется в бинарный фактор `diagnosis_bin` (0 — доброкачественная, 1 — злокачественная).
- Проверяется наличие пропущенных значений (NA). Если они есть, выводится предупреждение (заполнение средними значениями закомментировано и может быть активировано при необходимости).

## Модель

Модель представляет собой логистическую регрессию с LASSO-регуляризацией (`alpha = 1`), которая отбирает ключевые признаки, обнуляя коэффициенты незначительных. Основные шаги:
- Данные делятся на обучающую (80%) и тестовую (20%) выборки.
- Признаки стандартизируются (центрируются и масштабируются).
- Выполняется кросс-валидация для выбора оптимального значения параметра регуляризации λ.
- Модель обучается с использованием оптимального λ.

## Обучение и оценка

- Модель обучается на обучающей выборке с помощью `glmnet`.
- На тестовой выборке генерируются предсказания в виде вероятностей.
- Оптимальный порог классификации определяется с использованием статистики Юдена (Youden’s J statistic) на основе ROC-кривой.
- Оценивается производительность модели с помощью следующих метрик:
  - Accuracy (точность)
  - Precision (точность положительного класса)
  - Recall (полнота)
  - F1-score (гармоническое среднее precision и recall)
  - ROC AUC (площадь под ROC-кривой)

## Визуализация

Скрипт создаёт два графика:
1. **ROC-кривая**: отображает зависимость истинно-положительной доли (TPR) от ложно-положительной доли (FPR) и включает значение AUC.
2. **График важности признаков**: показывает ненулевые коэффициенты модели, иллюстрируя вклад каждого признака в предсказание.

## Использование

1. Поместите датасет в файл `data.csv` в рабочую директорию R.
2. Запустите скрипт:
   ```R
   source("predcancer.R")
   ```
3. После выполнения скрипт выведет метрики производительности и отобразит графики.

## Пример

Пример запуска:
```R
source("predcancer.R")
```

Ожидаемый вывод (примерные значения):
```
Результаты 10-кратной кросс-валидации:
...
Оптимальный порог (по Юдену): 0.478
Accuracy: 0.991
Precision: 0.977
Recall: 1
F1-score: 0.988
ROC AUC: 1
```

Графики:
- ROC-кривая с указанием AUC.
- График важности признаков с ненулевыми коэффициентами.


## FAQ

- **Как добавить новые признаки?**  
  Обновите файл `data.csv`, добавив новые столбцы, и убедитесь, что они корректно обрабатываются в скрипте.

- **Что делать, если модель не сходится?**  
  Проверьте данные на наличие NA, выбросов или сильной мультиколлинеарности.

- **Почему у модели такие высокие показатели?**
  Главным образом влияет довольно небольшого размера датасет, однако в реальных условиях точность должна быть не сильно ниже.
